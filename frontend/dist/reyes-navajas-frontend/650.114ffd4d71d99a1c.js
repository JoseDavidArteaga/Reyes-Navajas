"use strict";(self.webpackChunkreyes_navajas_frontend=self.webpackChunkreyes_navajas_frontend||[]).push([[650],{8650:(w,b,c)=>{c.r(b),c.d(b,{ReservarComponent:()=>C});var e=c(4438),d=c(177),a=c(4341),p=c(3897),v=c(9757);const m=()=>[1,2,3,4,5];function u(o,n){if(1&o){const t=e.RV6();e.j41(0,"div",17),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.selectService(i))}),e.j41(1,"div",18)(2,"h3",19),e.EFF(3),e.k0s(),e.j41(4,"p",20),e.EFF(5),e.k0s(),e.j41(6,"div",21)(7,"span",22),e.EFF(8),e.k0s(),e.j41(9,"span",23),e.EFF(10),e.k0s()()()()}if(2&o){let t;const r=n.$implicit,i=e.XpG();e.AVh("selected",(null==(t=i.selectedService())?null:t.id)===r.id),e.R7$(3),e.SpI(" ",r.nombre," "),e.R7$(2),e.SpI(" ",r.descripcion," "),e.R7$(3),e.SpI(" $",r.precio," "),e.R7$(2),e.SpI(" ",r.duracion," min ")}}function g(o,n){if(1&o&&(e.qSk(),e.j41(0,"svg",31),e.nrm(1,"path",32),e.k0s()),2&o){const t=n.$implicit,r=e.XpG().$implicit;e.HbH(t<=(r.rating||0)?"text-barberia-gold":"text-gray-600")}}function _(o,n){if(1&o){const t=e.RV6();e.j41(0,"div",26),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.selectBarbero(i))}),e.j41(1,"div",18)(2,"h3",19),e.EFF(3),e.k0s(),e.j41(4,"p",27),e.EFF(5),e.k0s(),e.j41(6,"div",28)(7,"div",28),e.DNE(8,g,2,2,"svg",29),e.j41(9,"span",30),e.EFF(10),e.k0s()()()()()}if(2&o){let t;const r=n.$implicit,i=e.XpG(2);e.AVh("selected",(null==(t=i.selectedBarbero())?null:t.id)===r.id),e.R7$(3),e.SpI(" ",r.nombre," "),e.R7$(2),e.SpI(" ",null==r.especialidades?null:r.especialidades.join(", ")," "),e.R7$(3),e.Y8G("ngForOf",e.lJ4(7,m))("ngForTrackBy",i.trackByIndex),e.R7$(2),e.SpI("(",r.rating||0,")")}}function h(o,n){if(1&o&&(e.j41(0,"div",5)(1,"div",6)(2,"span",24),e.EFF(3,"2"),e.k0s(),e.j41(4,"h2",8),e.EFF(5,"Selecciona tu Barbero"),e.k0s()(),e.j41(6,"div",9),e.DNE(7,_,11,8,"div",25),e.k0s()()),2&o){const t=e.XpG();e.R7$(7),e.Y8G("ngForOf",t.barberosDisponibles())("ngForTrackBy",t.trackByBarberoId)}}function f(o,n){1&o&&(e.j41(0,"p",40),e.EFF(1,"Selecciona una fecha v\xe1lida"),e.k0s())}function F(o,n){if(1&o){const t=e.RV6();e.j41(0,"button",41),e.bIt("click",function(){const i=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.selectTime(i))}),e.EFF(1),e.k0s()}if(2&o){const t=n.$implicit,r=e.XpG(2);e.AVh("selected",r.selectedTime()===t),e.Y8G("disabled",!r.isTimeAvailable(t)),e.R7$(),e.SpI(" ",t," ")}}function k(o,n){1&o&&(e.j41(0,"p",40),e.EFF(1,"Selecciona una hora"),e.k0s())}function y(o,n){if(1&o&&(e.j41(0,"div",5)(1,"div",6)(2,"span",24),e.EFF(3,"3"),e.k0s(),e.j41(4,"h2",8),e.EFF(5,"Fecha y Hora"),e.k0s()(),e.j41(6,"div",33)(7,"div",34)(8,"label",35),e.EFF(9,"Fecha de la cita"),e.k0s(),e.nrm(10,"input",36),e.DNE(11,f,2,0,"p",37),e.k0s(),e.j41(12,"div",34)(13,"label",35),e.EFF(14,"Hora de la cita"),e.k0s(),e.j41(15,"div",38),e.DNE(16,F,2,4,"button",39),e.k0s(),e.DNE(17,k,2,0,"p",37),e.k0s()()()),2&o){let t,r;const i=e.XpG();e.R7$(10),e.Y8G("min",i.minDate)("max",i.maxDate),e.R7$(),e.Y8G("ngIf",(null==(t=i.reservaForm.get("fecha"))?null:t.touched)&&(null==(t=i.reservaForm.get("fecha"))?null:t.errors)),e.R7$(5),e.Y8G("ngForOf",i.horasDisponibles())("ngForTrackBy",i.trackByHora),e.R7$(),e.Y8G("ngIf",(null==(r=i.reservaForm.get("hora"))?null:r.touched)&&(null==(r=i.reservaForm.get("hora"))?null:r.errors))}}function S(o,n){if(1&o&&(e.j41(0,"div",5)(1,"div",6)(2,"span",24),e.EFF(3,"4"),e.k0s(),e.j41(4,"h2",8),e.EFF(5,"Confirmaci\xf3n"),e.k0s()(),e.j41(6,"div",42)(7,"h3",43),e.EFF(8,"Resumen de tu cita"),e.k0s(),e.j41(9,"div",44)(10,"div",45)(11,"span",3),e.EFF(12,"Servicio:"),e.k0s(),e.j41(13,"span",46),e.EFF(14),e.k0s()(),e.j41(15,"div",45)(16,"span",3),e.EFF(17,"Barbero:"),e.k0s(),e.j41(18,"span",46),e.EFF(19),e.k0s()(),e.j41(20,"div",45)(21,"span",3),e.EFF(22,"Fecha:"),e.k0s(),e.j41(23,"span",46),e.EFF(24),e.k0s()(),e.j41(25,"div",45)(26,"span",3),e.EFF(27,"Hora:"),e.k0s(),e.j41(28,"span",46),e.EFF(29),e.k0s()(),e.j41(30,"div",45)(31,"span",3),e.EFF(32,"Duraci\xf3n:"),e.k0s(),e.j41(33,"span",46),e.EFF(34),e.k0s()()(),e.j41(35,"div",47)(36,"div",21)(37,"span",48),e.EFF(38,"Total:"),e.k0s(),e.j41(39,"span",49),e.EFF(40),e.k0s()()()()()),2&o){let t,r,i,s;const l=e.XpG();e.R7$(14),e.JRh(null==(t=l.selectedService())?null:t.nombre),e.R7$(5),e.JRh(null==(r=l.selectedBarbero())?null:r.nombre),e.R7$(5),e.JRh(l.formatDate(null==(i=l.reservaForm.get("fecha"))?null:i.value)),e.R7$(5),e.JRh(l.selectedTime()),e.R7$(5),e.SpI("",null==(s=l.selectedService())?null:s.duracion," min"),e.R7$(6),e.SpI(" $",l.getSelectedServicePrice()," ")}}function x(o,n){if(1&o){const t=e.RV6();e.j41(0,"button",50),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.nextStep())}),e.EFF(1," Siguiente "),e.k0s()}if(2&o){const t=e.XpG();e.Y8G("disabled",!t.isStepValid(t.currentStep()))}}function R(o,n){1&o&&(e.qSk(),e.j41(0,"svg",53),e.nrm(1,"circle",54)(2,"path",55),e.k0s())}function E(o,n){if(1&o&&(e.j41(0,"button",51),e.DNE(1,R,3,0,"svg",52),e.EFF(2," Confirmar Reserva "),e.k0s()),2&o){const t=e.XpG();e.Y8G("disabled",!t.reservaForm.valid||t.isLoading()),e.R7$(),e.Y8G("ngIf",t.isLoading())}}function j(o,n){1&o&&e.nrm(0,"app-loading-spinner")}let C=(()=>{class o{constructor(){this.servicioService=(0,e.WQX)(p.E5),this.barberoService=(0,e.WQX)(p.F$),this.reservaService=(0,e.WQX)(p.oO),this.fb=(0,e.WQX)(a.ok),this.servicios=this.servicioService.servicios,this.barberos=this.barberoService.barberos,this.isLoading=this.servicioService.isLoading,this.currentStep=(0,e.vPA)(1),this.selectedService=(0,e.vPA)(null),this.selectedBarbero=(0,e.vPA)(null),this.selectedTime=(0,e.vPA)(""),this.barberosDisponibles=(0,e.vPA)([]),this.horasDisponibles=(0,e.vPA)([]);const t=new Date;this.minDate=t.toISOString().split("T")[0];const r=new Date;r.setDate(t.getDate()+30),this.maxDate=r.toISOString().split("T")[0],this.reservaForm=this.fb.group({servicio:["",a.k0.required],barbero:["",a.k0.required],fecha:["",a.k0.required],hora:["",a.k0.required],notas:[""]}),this.servicioService.getAllServicios().subscribe(),this.barberoService.getAllBarberos().subscribe()}selectService(t){this.selectedService.set(t),this.reservaForm.patchValue({servicio:t.id});const r=this.barberos().filter(i=>i.especialidades?.some(s=>s.toLowerCase().includes(t.categoria?.toLowerCase()||"")));this.barberosDisponibles.set(r),1===this.currentStep()&&this.nextStep()}selectBarbero(t){this.selectedBarbero.set(t),this.reservaForm.patchValue({barbero:t.id}),2===this.currentStep()&&this.nextStep()}selectTime(t){this.selectedTime.set(t),this.reservaForm.patchValue({hora:t})}nextStep(){this.isStepValid(this.currentStep())&&(this.currentStep.set(this.currentStep()+1),3===this.currentStep()&&this.generateHorasDisponibles())}previousStep(){this.currentStep()>1&&this.currentStep.set(this.currentStep()-1)}isStepValid(t){return{1:!!this.selectedService(),2:!!this.selectedBarbero(),3:this.reservaForm.get("fecha")?.valid&&this.reservaForm.get("hora")?.valid}[t]??!0}generateHorasDisponibles(){const t=[];for(let r=9;r<18;r++)t.push(`${r.toString().padStart(2,"0")}:00`),t.push(`${r.toString().padStart(2,"0")}:30`);this.horasDisponibles.set(t)}isTimeAvailable(t){return!0}getSelectedServicePrice(){return this.selectedService()?.precio||0}formatDate(t){return t?new Date(t).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}onSubmit(){if(this.reservaForm.valid){const t={servicioId:this.selectedService()?.id,barberoId:this.selectedBarbero()?.id,fechaHora:`${this.reservaForm.get("fecha")?.value}T${this.reservaForm.get("hora")?.value}`,notas:this.reservaForm.get("notas")?.value||""};this.reservaService.createReserva(t).subscribe({next:r=>console.log("Reserva creada",r),error:r=>console.error("Error",r)})}}trackByServicioId(t,r){return r.id}trackByBarberoId(t,r){return r.id}trackByHora(t,r){return r}trackByIndex(t){return t}static{this.\u0275fac=function(r){return new(r||o)}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-reservar"]],standalone:!0,features:[e.aNF],decls:24,vars:12,consts:[[1,"max-w-4xl","mx-auto","p-6"],[1,"mb-8"],[1,"text-3xl","font-display","font-bold","text-gray-100","mb-2"],[1,"text-gray-400"],[3,"ngSubmit","formGroup"],[1,"step-container"],[1,"step-header"],[1,"step-number"],[1,"text-xl","font-semibold","text-gray-100"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4","mt-6"],["class","service-card",3,"selected","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","step-container",4,"ngIf"],[1,"flex","justify-between","mt-8","pt-6","border-t","border-gray-700"],["type","button",1,"btn-secondary",3,"click","disabled"],["type","button","class","btn-primary",3,"disabled","click",4,"ngIf"],["type","submit","class","btn-primary",3,"disabled",4,"ngIf"],[4,"ngIf"],[1,"service-card",3,"click"],[1,"p-4"],[1,"text-lg","font-semibold","text-gray-100","mb-2"],[1,"text-gray-400","text-sm","mb-3"],[1,"flex","justify-between","items-center"],[1,"text-barberia-gold","font-semibold"],[1,"text-sm","text-gray-500"],[1,"step-number","active"],["class","barbero-card",3,"selected","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"barbero-card",3,"click"],[1,"text-gray-400","text-sm","mb-2"],[1,"flex","items-center"],["class","w-4 h-4","fill","currentColor","viewBox","0 0 20 20",3,"class",4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-sm","text-gray-400","ml-2"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4"],["d","M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6","mt-6"],[1,"card"],[1,"form-label"],["type","date","formControlName","fecha",1,"form-input",3,"min","max"],["class","form-error",4,"ngIf"],[1,"grid","grid-cols-3","gap-2"],["type","button","class","time-button",3,"selected","disabled","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"form-error"],["type","button",1,"time-button",3,"click","disabled"],[1,"card","mt-6"],[1,"text-lg","font-semibold","text-gray-100","mb-4"],[1,"space-y-3"],[1,"flex","justify-between"],[1,"text-gray-100"],[1,"pt-4","border-t","border-gray-700"],[1,"text-lg","font-semibold","text-gray-100"],[1,"text-2xl","font-bold","text-barberia-gold"],["type","button",1,"btn-primary",3,"click","disabled"],["type","submit",1,"btn-primary",3,"disabled"],["class","animate-spin h-4 w-4 mr-2","viewBox","0 0 24 24",4,"ngIf"],["viewBox","0 0 24 24",1,"animate-spin","h-4","w-4","mr-2"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"h1",2),e.EFF(3," Reservar Cita "),e.k0s(),e.j41(4,"p",3),e.EFF(5," Selecciona un servicio, barbero y horario para tu cita "),e.k0s()(),e.j41(6,"form",4),e.bIt("ngSubmit",function(){return i.onSubmit()}),e.j41(7,"div",5)(8,"div",6)(9,"span",7),e.EFF(10,"1"),e.k0s(),e.j41(11,"h2",8),e.EFF(12,"Selecciona un Servicio"),e.k0s()(),e.j41(13,"div",9),e.DNE(14,u,11,6,"div",10),e.k0s()(),e.DNE(15,h,8,2,"div",11)(16,y,18,6,"div",11)(17,S,41,6,"div",11),e.j41(18,"div",12)(19,"button",13),e.bIt("click",function(){return i.previousStep()}),e.EFF(20," Anterior "),e.k0s(),e.DNE(21,x,2,1,"button",14)(22,E,3,2,"button",15),e.k0s()(),e.DNE(23,j,1,0,"app-loading-spinner",16),e.k0s()),2&r&&(e.R7$(6),e.Y8G("formGroup",i.reservaForm),e.R7$(3),e.AVh("active",i.currentStep()>=1),e.R7$(5),e.Y8G("ngForOf",i.servicios())("ngForTrackBy",i.trackByServicioId),e.R7$(),e.Y8G("ngIf",i.currentStep()>=2),e.R7$(),e.Y8G("ngIf",i.currentStep()>=3),e.R7$(),e.Y8G("ngIf",i.currentStep()>=4),e.R7$(2),e.Y8G("disabled",1===i.currentStep()),e.R7$(2),e.Y8G("ngIf",i.currentStep()<4),e.R7$(),e.Y8G("ngIf",i.currentStep()>=4),e.R7$(),e.Y8G("ngIf",i.isLoading()))},dependencies:[d.MD,d.Sq,d.bT,a.X1,a.qT,a.me,a.BC,a.cb,a.j4,a.JD,v.NB],styles:[".step-container[_ngcontent-%COMP%]{margin-bottom:2rem;border-radius:.5rem;border-width:1px;--tw-border-opacity: 1;border-color:rgb(55 65 81 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1));padding:1.5rem}.step-header[_ngcontent-%COMP%]{display:flex;align-items:center}.step-header[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not([hidden]) ~ [_ngcontent-%COMP%]:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.75rem * var(--tw-space-x-reverse));margin-left:calc(.75rem * calc(1 - var(--tw-space-x-reverse)))}.step-number[_ngcontent-%COMP%]{display:flex;height:2rem;width:2rem;align-items:center;justify-content:center;border-radius:9999px;--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1));font-size:.875rem;line-height:1.25rem;font-weight:600;--tw-text-opacity: 1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.step-number.active[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(212 175 55 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.service-card[_ngcontent-%COMP%], .barbero-card[_ngcontent-%COMP%]{cursor:pointer;border-radius:.5rem;border-width:1px;--tw-border-opacity: 1;border-color:rgb(55 65 81 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1));transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.service-card[_ngcontent-%COMP%]:hover, .barbero-card[_ngcontent-%COMP%]:hover{border-color:#d4af3780}.service-card.selected[_ngcontent-%COMP%], .barbero-card.selected[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(212 175 55 / var(--tw-border-opacity, 1));background-color:#d4af371a}.time-button[_ngcontent-%COMP%]{border-radius:.25rem;border-width:1px;--tw-border-opacity: 1;border-color:rgb(55 65 81 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1));padding:.5rem;font-size:.875rem;line-height:1.25rem;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.time-button[_ngcontent-%COMP%]:hover{border-color:#d4af3780}.time-button.selected[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(212 175 55 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(212 175 55 / var(--tw-bg-opacity, 1));--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.time-button[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.5}"],changeDetection:0})}}return o})()}}]);